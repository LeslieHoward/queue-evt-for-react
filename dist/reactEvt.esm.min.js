import r,{Component as t}from"react";import n from"hoist-non-react-statics";import{Signal as e}from"queue-evt";function o(){return(o=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])}return r}).apply(this,arguments)}var u={type:function(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()},isNull:function(r){var t;for(t in r)return!1;return!0},notNull:function(r){return!u.isNull(r)},isArray:function(r){return"array"===u.type(r)},isFunction:function(r){return"function"===u.type(r)},uuid:function(){var r=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==t?n:3&n|8).toString(16)}));return t}},i=new e,c=function(e){return function(c){var f=n(function(t){var n,f;function a(n){var e;return(e=t.call(this,n)||this).sourceRef=e.props.forwardRef||r.createRef(),e}f=t,(n=a).prototype=Object.create(f.prototype),n.prototype.constructor=n,n.__proto__=f;var x=a.prototype;return x.componentDidMount=function(){var r=this;u.notNull(this.sourceRef.current)&&u.isArray(e)&&e.forEach((function(t){var n=t.action,e=t.handler;t.token=u.uuid(),"function"==typeof e&&i.on(n,e.bind(r.sourceRef.current),{token:t.token})}))},x.componentWillUnmount=function(){u.isArray(e)&&e.forEach((function(r){var t=r.action,n=r.token;i.remove(t,n)}))},x.render=function(){var t=this.props,n=(t.forwardRef,function(r,t){if(null==r)return{};var n,e,o={},u=Object.keys(r);for(e=0;e<u.length;e++)n=u[e],t.indexOf(n)>=0||(o[n]=r[n]);return o}(t,["forwardRef"]));return r.createElement(c,o({},n,{ref:this.sourceRef}))},a}(t),c);return r.forwardRef((function(t,n){return r.createElement(f,o({},t,{forwardRef:n}))}))}},f=i.emit;export{c as connect,f as emit};
