import t,{Component as r}from"react";import e from"hoist-non-react-statics";import{Signal as n}from"queue-evt";function o(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,r){return(i=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function f(t,r){if(null==t)return{};var e,n,o=function(t,r){if(null==t)return{};var e,n,o={},u=Object.keys(t);for(n=0;n<u.length;n++)e=u[n],r.indexOf(e)>=0||(o[e]=t[e]);return o}(t,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(n=0;n<u.length;n++)e=u[n],r.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(o[e]=t[e])}return o}function a(t,r){return!r||"object"!=typeof r&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function l(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=c(t);if(r){var o=c(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return a(this,e)}}var s={type:function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},isNull:function(t){var r;for(r in t)return!1;return!0},notNull:function(t){return!s.isNull(t)},isArray:function(t){return"array"===s.type(t)},isFunction:function(t){return"function"===s.type(t)},uuid:function(){var t=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var e=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==r?e:3&e|8).toString(16)}));return r}},p=new n,y=function(n){return function(c){var a=e(function(e){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&i(t,r)}(v,r);var a,y,x,h=l(v);function v(r){var e;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,v),(e=h.call(this,r)).sourceRef=e.props.forwardRef||t.createRef(),e}return a=v,(y=[{key:"componentDidMount",value:function(){var t=this;s.notNull(this.sourceRef.current)&&s.isArray(n)&&n.forEach((function(r){var e=r.action,n=r.handler;r.token=s.uuid(),"function"==typeof n&&p.on(e,n.bind(t.sourceRef.current),{token:r.token})}))}},{key:"componentWillUnmount",value:function(){s.isArray(n)&&n.forEach((function(t){var r=t.action,e=t.token;p.remove(r,e)}))}},{key:"render",value:function(){var r=this.props,e=(r.forwardRef,f(r,["forwardRef"]));return t.createElement(c,u({},e,{ref:this.sourceRef}))}}])&&o(a.prototype,y),x&&o(a,x),v}(),c);return t.forwardRef((function(r,e){return t.createElement(a,u({},r,{forwardRef:e}))}))}},x=p.emit;export{y as connect,x as emit};
